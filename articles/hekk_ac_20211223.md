---
title: "エンジニアが振り返る2021年のメルクストーリア(前編)"
emoji: "🔔"
type: "idea" # tech: 技術記事 / idea: アイデア
topics: ["ソーシャルゲーム"]
publication_name: "happy_elements"
published: true
published_at: 2021-12-23 12:00
---

# はじめに
この記事はHappy Elements Advent Calendar 2021 23日目の記事になります。

# 背景
メルクストーリアチームでエンジニアリーダーをしている上田と申します。
（ときどき生放送やTVで登場している柔らかい上田とは別の上田です）

去年、アドベントカレンダーのほうで「[エンジニアが振り返る2020年のメルクストーリア](https://zenn.dev/happy_elements/articles/hekk_ac_20201213)」という投稿をさせていただいたのですが、今年も書くよね？という空気を感じ取り、同様の趣旨で今年を振り返ってみます。

記事が長いので今日は前編、明日は後編という形でお送りいたします。

※ 内容はメルクストーリアの動作や仕様、過去に開催されたイベントに関するある程度の知識が前提となっています。
※ 去年の続きということで12月からの内容について振り返っています。
※ 記事の内容は個人の想いでありチームの総意ではありません。

# 2020年12月
## メルクストーリアへのお便り募集
プランナーが子供のときにあるゲームのプロデューサーさんからもらった直筆のお手紙がとてもうれしかった。
メルストでもユーザー様に感謝のお手紙を返したいとのことで開催されました。

想定していたよりとてもたくさんのお手紙をいただき運営一同ビックリしました。
毎日届くものすごく凝ったお手紙に「うわ・・！！」「すごい・・！」しか言葉を発せられない人みたいになってました。

お返事のお手紙はプランナーの方で書かせていただいたのですが、量が多くて全てお返しするのに時間がかかってしまって申し訳ありませんでした。
お返事を書いている頃、時々、近くの席から「あ、字間違えた！！」という叫びが聞こえてました。

## 冬のワクワク体験入隊キャンペーン
ラインストラテジーはパズルなんだ、どのタイミングで何を出してSPのやりくりをしてぎりぎりクリアできたときの達成感がとても気持ちいい。
メルストを作ることを決める前にこんなことをリーダーが言っており、結果的にはスカウトのシステムが導入されたことでユーザー様毎の環境は異なることとなり、最初に思ったラインストラテジーとは少し違うものとなりました。

いつか全ユーザー様が共通のパーティーでクエストに挑むようなパズル的なものが作れたら楽しいんじゃないだろうかと思っており、実現できて良かったです。

開発が結構大変で、それなりに長い時間をかけて開発されたのですが、冬休み中にリリースとのことでじっくりプレイしてもらえたらいいなぁ、クリアできないユーザー様に他のユーザー様が動画共有してくれたりしてコミュニケーションとってもらえたらいいなぁ、などと思っていたのですが・・・。

実際には開始後すぐに続々とクリアされるユーザー様が多くて、1週間煮込んだスープを5分でお客様に食べられちゃうシェフみたいな気持ちでした。

日々、複雑になり続けるメルストのパーティー戦略が周知されたのは良かったと思います。
リトラクトパーティーに関しては悩んだ末に公開をしました。

## 妖怪くじえれきてる
この回で妖怪くじは一応終了です。
たくさん買われると当たる確率下がるから他のユーザーさんは買わないでほしいなぁみたいな雰囲気があんまりよくないかなというのと、当たっても言い出しにくいのがいまいちかなぁというのが理由です。
たいてんき様もダイヤを集めるのが大変そうですし。

# 2021年1月
## ルーン強化機能の改修(複数の素材ルーンを選択し一括して強化)
チームのエンジニアの方がルーン強化ぽちぽち面倒だーと言って開発してくれました。
おかげで自分もルーンハントで33ルーンを作るのが楽になりました。

## プロテクトルーン
リリース前に表示だけ公開されてしまい申し訳ありませんでした。
上位ルーンを作るのは大変で、それまでのつなぎとして前衛につけてもらえるようなイメージで作りました。
救援のルーン一括装備で、プロテクトルーンを指定してルーンを一気に外すということをユーザー様が言っておられて目から鱗でした。なるほど。

# 2021年3月
## ギルド画面の改修
昨年リアルタイム通信に取り組んでいるという記事がここにつながります。

### マップ
座標やスタンプや会話をリアルタイム化しています。

### ギルバト画面
ここが一番対応したかったところです。
この画面でリアルタイム対応しているのは会話だけなのですが、以前はギルドマスターから「祈りストップ」や「3位キープ」みたいな指示が届くのにラグがありもどかしい思いをしていました。
会話が即時反映されることによって指示がしやすくなっていたらいいなと思います。

### 応援・祈りのオート
連打をするのに指が痛いのでオート機能をいれました。

機能公開後、「遅いから使えませんね」と言われて、そうかぁ・・・と残念でした。
あまり速くしてしまうとサーバーの負荷が高くなるという事情もあったりします。

個人的にはこれを使って祈っています。
これで指が痛くならないから大丈夫と思ってたのですが、30分間じっと指を置いているのも、それはそれで疲れますね。

## 「ゆるキャン△」とのコラボイベント
ずいぶん前から着手していたのですが、ようやくお披露目できました。
イベント画面をとてもにぎやかにしてもらったり、オブジェクトをタップすると動くようにしてもらったりと、画面を見ているだけで楽しくなりました。

# 2021年4月
## オート周回機能の改善
ああ、こんな機能ほしいなぁ、時間があったら作るんだけどなぁ、忙しいのだよなぁとぼやいてたら隣の席のエンジニアが作ってくれました。
進化したら止まって欲しいよね？とか鈴も使って欲しいよね？と言ってたら、それも対応してもらえました。ありがとうございます！

鈴の消費は担当エンジニアこだわりの部分で「このクエストでFever終了するので、すぐに鈴を使うことでFeverじゃないクエストがでてしまうことを防ぐ」という作りになっています。

# 2021年5月
## サーバー機器交換に伴うメンテナンス
この施策に関連し多くの不具合を発生させてしまい申し訳ありませんでした。
サーバー交換だけでこんなに不具合起こるわけないよねと言っておられるユーザー様がいましたが、実際には裏でいろいろ対応していました。

具体的には、オンプレミスからクラウドへ動作環境をお引越ししています。
プログラム言語・フレームワーク・ライブラリの最新バージョンへの移行、KVSからRDSへの移行とシャーディング対応、データのお引越しなどです。

数年前からプランナーにできないの？と打診されていて困難すぎてお断りしていたのですが、クラウド移行しなければ実現できないことがあったので対応を決めました。

# 2021年6月
## ダイヤバックなどの判定にユニット名鑑の覚醒ランクも含める仕様変更
ダイヤバックのために毎回名鑑からユニットを出してスカウトを引くというのが大変というので対応をしました。
名鑑に着せ替え前と後を15覚醒させたものを置いてユニットへの愛を示す！というのが出来なくなりますねという懸念があったのですが、そこはもうしょうがないかなと諦めました・・・ごめんなさい。
便利になったかなと思います。
